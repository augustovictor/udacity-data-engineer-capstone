DROP TABLE IF EXISTS staging_game_match;
CREATE TABLE IF NOT EXISTS staging_game_match (
    game_creation BIGINT,
    game_duration SMALLINT,
    game_id BIGINT,
    game_mode VARCHAR(100),
    game_type VARCHAR(100),
    team_team_id SMALLINT,
    participant_participant_id SMALLINT,
    team_win VARCHAR(10),
    team_first_blood BOOLEAN,
    team_first_tower BOOLEAN,
    team_first_inhibitor BOOLEAN,
    team_first_baron BOOLEAN,
    team_first_dragon BOOLEAN,
    team_first_rift_herald BOOLEAN,
    team_tower_kills SMALLINT,
    team_baron_kills SMALLINT,
    team_dragon_kills SMALLINT,
    team_vilemaw_kills SMALLINT,
    team_rift_herald_kills SMALLINT,
    participant_champion_id INTEGER,
    participant_spell1_id SMALLINT,
    participant_spell2_id SMALLINT,
    participant_stats_win BOOLEAN,
    participant_stats_item0 SMALLINT,
    participant_stats_item1 SMALLINT,
    participant_stats_item2 SMALLINT,
    participant_stats_item3 SMALLINT,
    participant_stats_item4 SMALLINT,
    participant_stats_item5 SMALLINT,
    participant_stats_item6 SMALLINT,
    participant_stats_kills SMALLINT,
    participant_stats_deaths SMALLINT,
    participant_stats_assists SMALLINT,
    participant_stats_largest_killing_spree SMALLINT,
    participant_stats_largest_multi_kill SMALLINT,
    participant_stats_killing_sprees SMALLINT,
    participant_stats_longest_time_spent_living SMALLINT,
    participant_stats_double_kills SMALLINT,
    participant_stats_triple_kills SMALLINT,
    participant_stats_quadra_kills SMALLINT,
    participant_stats_penta_kills SMALLINT,
    participant_stats_unreal_kills SMALLINT,
    participant_stats_total_damage_dealt INTEGER,
    participant_stats_magic_damage_dealt INTEGER,
    participant_stats_physical_damage_dealt INTEGER,
    participant_stats_true_damage_dealt INTEGER,
    participant_stats_largest_critical_strike INTEGER,
    participant_stats_total_damage_dealt_to_champions INTEGER,
    participant_stats_magic_damage_dealt_to_champions INTEGER,
    participant_stats_physical_damage_dealt_to_champions INTEGER,
    participant_stats_true_damage_dealt_to_champions INTEGER,
    participant_stats_total_heal INTEGER,
    participant_stats_total_units_healed INTEGER,
    participant_stats_damage_self_mitigated INTEGER,
    participant_stats_damage_dealt_to_objectives INTEGER,
    participant_stats_damage_dealt_to_turrets INTEGER,
    participant_stats_total_damage_taken INTEGER,
    participant_stats_magical_damage_taken INTEGER,
    participant_stats_physical_damage_taken INTEGER,
    participant_stats_true_damage_taken INTEGER,
    participant_stats_gold_earned INTEGER,
    participant_stats_gold_spent INTEGER,
    participant_stats_turret_kills INTEGER,
    participant_stats_inhibitor_kills INTEGER,
    participant_stats_total_minions_killed SMALLINT,
    participant_stats_neutral_minions_killed SMALLINT,
    participant_stats_neutral_minions_killed_team_jungle SMALLINT,
    participant_stats_neutral_minions_killed_enemy_jungle SMALLINT,
    participant_stats_total_time_crowd_control_dealt INTEGER,
    participant_stats_champ_level SMALLINT,
    participant_stats_vision_wards_bought_in_game INTEGER,
    participant_stats_sight_wards_bought_in_game INTEGER,
    participant_stats_wards_placed SMALLINT,
    participant_stats_wards_killed SMALLINT,
    participant_stats_first_blood_kill BOOLEAN,
    participant_stats_first_blood_assist BOOLEAN,
    participant_stats_first_tower_kill BOOLEAN,
    participant_stats_first_tower_assist BOOLEAN,
    participant_stats_first_inhibitor_kill BOOLEAN,
    participant_stats_first_inhibitor_assist BOOLEAN,
    creeps_per_min_deltas_0_10 DECIMAL(25,18),
    creeps_per_min_deltas_10_20 DECIMAL(25,18),
    creeps_per_min_deltas_20_30 DECIMAL(25,18),
    creeps_per_min_deltas_30_end DECIMAL(25,18),
    xp_per_min_deltas_0_10 DECIMAL(25,18),
    xp_per_min_deltas_10_20 DECIMAL(25,18),
    xp_per_min_deltas_20_30 DECIMAL(25,18),
    xp_per_min_deltas_30_end DECIMAL(25,18),
    gold_per_min_deltas_0_10 DECIMAL(25,18),
    gold_per_min_deltas_10_20 DECIMAL(25,18),
    gold_per_min_deltas_20_30 DECIMAL(25,18),
    gold_per_min_deltas_30_end DECIMAL(25,18),
    cs_diff_per_min_deltas_0_10 DECIMAL(25,18),
    cs_diff_per_min_deltas_10_20 DECIMAL(25,18),
    cs_diff_per_min_deltas_20_30 DECIMAL(25,18),
    cs_diff_per_min_deltas_30_end DECIMAL(25,18),
    xp_diff_per_min_deltas_0_10 DECIMAL(25,18),
    xp_diff_per_min_deltas_10_20 DECIMAL(25,18),
    xp_diff_per_min_deltas_20_30 DECIMAL(25,18),
    xp_diff_per_min_deltas_30_end DECIMAL(25,18),
    damage_taken_per_min_deltas_0_10 DECIMAL(25,18),
    damage_taken_per_min_deltas_10_20 DECIMAL(25,18),
    damage_taken_per_min_deltas_20_30 DECIMAL(25,18),
    damage_taken_per_min_deltas_30_end DECIMAL(25,18),
    damage_taken_diff_per_min_deltas_0_10 DECIMAL(25,18),
    damage_taken_diff_per_min_deltas_10_20 DECIMAL(25,18),
    damage_taken_diff_per_min_deltas_20_30 DECIMAL(25,18),
    damage_taken_diff_per_min_deltas_30_end DECIMAL(25,18),
    participant_timeline_role VARCHAR(100),
    participant_timeline_lane VARCHAR(100),
    participant_identity_participant_i SMALLINT,
    participant_identity_player_platform_id VARCHAR(5),
    participant_identity_player_account_id VARCHAR(255),
    participant_identity_player_summoner_id VARCHAR(255),
    ts VARCHAR(50),
    year SMALLINT,
    month SMALLINT
);

DROP TABLE IF EXISTS fact_game_match;
CREATE TABLE IF NOT EXISTS fact_game_match (
    game_creation BIGINT,
    game_duration SMALLINT,
    game_id BIGINT,
    game_mode VARCHAR(100),
    game_type VARCHAR(100),
    team_team_id SMALLINT,
    participant_participant_id SMALLINT,
    team_win VARCHAR(10),
    team_first_blood BOOLEAN,
    team_first_tower BOOLEAN,
    team_first_inhibitor BOOLEAN,
    team_first_baron BOOLEAN,
    team_first_dragon BOOLEAN,
    team_first_rift_herald BOOLEAN,
    team_tower_kills SMALLINT,
    team_baron_kills SMALLINT,
    team_dragon_kills SMALLINT,
    team_vilemaw_kills SMALLINT,
    team_rift_herald_kills SMALLINT,
    participant_champion_id INTEGER,
    participant_spell1_id SMALLINT,
    participant_spell2_id SMALLINT,
    participant_stats_win BOOLEAN,
    participant_stats_item0 SMALLINT,
    participant_stats_item1 SMALLINT,
    participant_stats_item2 SMALLINT,
    participant_stats_item3 SMALLINT,
    participant_stats_item4 SMALLINT,
    participant_stats_item5 SMALLINT,
    participant_stats_item6 SMALLINT,
    participant_stats_kills SMALLINT,
    participant_stats_deaths SMALLINT,
    participant_stats_assists SMALLINT,
    participant_stats_largest_killing_spree SMALLINT,
    participant_stats_largest_multi_kill SMALLINT,
    participant_stats_killing_sprees SMALLINT,
    participant_stats_longest_time_spent_living SMALLINT,
    participant_stats_double_kills SMALLINT,
    participant_stats_triple_kills SMALLINT,
    participant_stats_quadra_kills SMALLINT,
    participant_stats_penta_kills SMALLINT,
    participant_stats_unreal_kills SMALLINT,
    participant_stats_total_damage_dealt INTEGER,
    participant_stats_magic_damage_dealt INTEGER,
    participant_stats_physical_damage_dealt INTEGER,
    participant_stats_true_damage_dealt INTEGER,
    participant_stats_largest_critical_strike INTEGER,
    participant_stats_total_damage_dealt_to_champions INTEGER,
    participant_stats_magic_damage_dealt_to_champions INTEGER,
    participant_stats_physical_damage_dealt_to_champions INTEGER,
    participant_stats_true_damage_dealt_to_champions INTEGER,
    participant_stats_total_heal INTEGER,
    participant_stats_total_units_healed INTEGER,
    participant_stats_damage_self_mitigated INTEGER,
    participant_stats_damage_dealt_to_objectives INTEGER,
    participant_stats_damage_dealt_to_turrets INTEGER,
    participant_stats_total_damage_taken INTEGER,
    participant_stats_magical_damage_taken INTEGER,
    participant_stats_physical_damage_taken INTEGER,
    participant_stats_true_damage_taken INTEGER,
    participant_stats_gold_earned INTEGER,
    participant_stats_gold_spent INTEGER,
    participant_stats_turret_kills INTEGER,
    participant_stats_inhibitor_kills INTEGER,
    participant_stats_total_minions_killed SMALLINT,
    participant_stats_neutral_minions_killed SMALLINT,
    participant_stats_neutral_minions_killed_team_jungle SMALLINT,
    participant_stats_neutral_minions_killed_enemy_jungle SMALLINT,
    participant_stats_total_time_crowd_control_dealt INTEGER,
    participant_stats_champ_level SMALLINT,
    participant_stats_vision_wards_bought_in_game INTEGER,
    participant_stats_sight_wards_bought_in_game INTEGER,
    participant_stats_wards_placed SMALLINT,
    participant_stats_wards_killed SMALLINT,
    participant_stats_first_blood_kill BOOLEAN,
    participant_stats_first_blood_assist BOOLEAN,
    participant_stats_first_tower_kill BOOLEAN,
    participant_stats_first_tower_assist BOOLEAN,
    participant_stats_first_inhibitor_kill BOOLEAN,
    participant_stats_first_inhibitor_assist BOOLEAN,
    creeps_per_min_deltas_0_10 DECIMAL(25,18),
    creeps_per_min_deltas_10_20 DECIMAL(25,18),
    creeps_per_min_deltas_20_30 DECIMAL(25,18),
    creeps_per_min_deltas_30_end DECIMAL(25,18),
    xp_per_min_deltas_0_10 DECIMAL(25,18),
    xp_per_min_deltas_10_20 DECIMAL(25,18),
    xp_per_min_deltas_20_30 DECIMAL(25,18),
    xp_per_min_deltas_30_end DECIMAL(25,18),
    gold_per_min_deltas_0_10 DECIMAL(25,18),
    gold_per_min_deltas_10_20 DECIMAL(25,18),
    gold_per_min_deltas_20_30 DECIMAL(25,18),
    gold_per_min_deltas_30_end DECIMAL(25,18),
    cs_diff_per_min_deltas_0_10 DECIMAL(25,18),
    cs_diff_per_min_deltas_10_20 DECIMAL(25,18),
    cs_diff_per_min_deltas_20_30 DECIMAL(25,18),
    cs_diff_per_min_deltas_30_end DECIMAL(25,18),
    xp_diff_per_min_deltas_0_10 DECIMAL(25,18),
    xp_diff_per_min_deltas_10_20 DECIMAL(25,18),
    xp_diff_per_min_deltas_20_30 DECIMAL(25,18),
    xp_diff_per_min_deltas_30_end DECIMAL(25,18),
    damage_taken_per_min_deltas_0_10 DECIMAL(25,18),
    damage_taken_per_min_deltas_10_20 DECIMAL(25,18),
    damage_taken_per_min_deltas_20_30 DECIMAL(25,18),
    damage_taken_per_min_deltas_30_end DECIMAL(25,18),
    damage_taken_diff_per_min_deltas_0_10 DECIMAL(25,18),
    damage_taken_diff_per_min_deltas_10_20 DECIMAL(25,18),
    damage_taken_diff_per_min_deltas_20_30 DECIMAL(25,18),
    damage_taken_diff_per_min_deltas_30_end DECIMAL(25,18),
    participant_timeline_role VARCHAR(100),
    participant_timeline_lane VARCHAR(100),
    participant_identity_participant_i SMALLINT,
    participant_identity_player_platform_id VARCHAR(5),
    participant_identity_player_account_id VARCHAR(255),
    participant_identity_player_summoner_id VARCHAR(255),
    ts VARCHAR(50),
    year SMALLINT,
    month SMALLINT
);
